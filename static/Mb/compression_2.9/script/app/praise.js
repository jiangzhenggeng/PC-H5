define(["jquery","app/login","layer"],function(a,b,c){return{init:function(){a("body").on("click","[data-zan]",function(){if(!window.URL.login)return b.login(),!1;var d=a(this),e=d.attr("data-id"),f=d.attr("data-add-praiselist");d.hasClass("zan-on")||a.post("/api/praise/praise",{id_value:e,type:3},function(e){if(e.resultCode==0)if(e.result.zan==1){d.addClass("zan-on").find("i").addClass("on animate");var g=parseInt(d.find("[data-praise-num]").text()||0)+1,h=parseInt(d.find("[data-praise-every]").text()||0)+1,i=a("body").find("[data-praise-num]");i.each(function(b){a(i[b]).text(g)}),d.find("[data-praise-every]").text(h),setTimeout(function(){d.addClass("zan-on").find("i").removeClass("animate")},700);if(f){var j=""+e.result.avatar+"/230x230",k="<li><img src="+j+"></li>",l=a("#praise-list");l.find("li").length?l.find("li").first().before(k):(a("#praise-list-box").removeClass("none"),l.append(k))}}else d.removeClass("zan-on").find("i").removeClass("on");else e.resultCode==-100?b.login():c.msg("操作失败~请稍后再试")},"json")})}}})